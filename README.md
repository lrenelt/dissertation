This repository contains the code to reproduce the results from 'Numerical methods for Friedrichsâ€™ systems: Approximation theory, localized training and inherently stable model order reduction' by Lukas Renelt.

The code is based on Dune-PDELab and its dependencies which are all included as submodules. After you have cloned this repository you need to invoke 'git submodule init' and 'git submodule update' to fetch the submodules contents. Alternatively you can clone this repository with the option '--recurse-submodules'.

## Setup of the build system

In order to configure the build system call (from the base directory)

    ./dune-common/bin/dunecontrol --opts=default.opts configure

This will initialise the build directory for all modules. Afterwards, you can build Dune-PDELab and all dependent modules via

    ./dune-common/bin/dunecontrol --opts=default.opts --module=dune-pdelab make

## Setup of the python environment for the parametric and localized tests

The tests for the parametrized problem are implemented in python using python-bindings for the DUNE code. To build the python-module change to the base directory and run

    ./dune-common/bin/dunecontrol --opts=default.opts --only=dune-ultraweak make ipyultraweak

Afterwards, you can activate the python environment via

    source pyenv.sh

and which will automatically change to '*dune-ultraweak-build-dir*/python'.

## Chapter 3

For all tests, setup the build directory and change to the subfolder 'dune-ultraweak/dune/ultraweak/test'.

To reproduce the results from Figure 3.5, change to the subfolder 'transport'. Build the test via

    make computeTransportExampleSolutions

and run it, results are stored as '.vtu'-files.

To generate the data for Figure 3.6, change to the subfolder 'transport'. Build the tests via

    make runAllClassicConvergenceTestsTransport
    make runAllAdjointConvergenceTestsTransport

and run them, results are stored as '.csv'-files.

To generate the data for Figure 3.8, change to the subfolder 'convection-diffusion/thermalblock/'. Build the executable via

    make solveThermalblockNormalEq

and run it, results are stored as '.vtu'-files.

To generate the data for Figure 3.9, change to the subfolder 'convection-diffusion/thermalblock/'. Build the tests via

    make runAllClassicConvergenceTestsThermalblock
    make runAllAdjointConvergenceTestsThermalblock

and run them, results are stored as '.csv'-files.

To generate the data for Figure 3.12, change to the subfolder 'convection-diffusion'. Build the tests via

    make runConvergenceTestConvDiff

and run it, results are stored as '.csv'-files. To generate the figure on the right and the solutions in Figure 3.13, build and run

    make solveConvDiffNormalEq


## Chapter 4

The results in this section require the setup of the python-bindings as detailled above. Activate the virtualenv and change to the subfolder 'dune-ultraweak/python/' in the build-directory.

For the solutions in Figure 4.2, change to the subfolder 'dune-ultraweak/python/transport' and run

    python3 computeExampleSolutions.py

For the data used in Figure 4.3, run

    python3 test_norms.py

The data shown in Figure 4.4 can be generated by running

    python3 runAllGreedyTests.py

For the solutions in Figure 4.6 and Figure 4.7, change to the subdirectory 'dune-ultraweak/python/convectionDiffusion' and run

    python3 computeExampleSolutions.py

The data visualized in Figure 4.8 can be generated by running

    python3 runAllGreedyTests.py

## Chapter 5

Again, we assume that the python-bindings have been build and the virtualenv is active. Change to the subfolder 'dune-ultraweak/python/convectionDiffusion/localized'.

For the FOSLS solutions in Figure 5.3, 5.10 and 5.13 run

    python3 computeLocalExampleSolutions.py

The ultraweak solutions in Figure 5.5 and 5.12 run

    python3 computeLocalAdjointExampleSolutions.py

The convergence data in Figure 5.4, 5.6, 5.7, 5.11 and 5.14 can all be generated by

    python3 runAllRangefinderTests.py



